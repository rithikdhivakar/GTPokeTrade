{% extends 'base.html' %}
{% block content %}
<h2>Incoming Trade Requests</h2>

{% if incoming_requests %}
  <ul>
    {% for trade in incoming_requests %}
      <li style="margin-bottom: 20px; border-bottom: 1px solid #ccc; padding-bottom: 10px;">
        <strong>From:</strong> {{ trade.from_user.userprofile.display_name|default:trade.from_user.username }}<br>

        <strong>Wants to trade:</strong><br>
        {% for card in trade.offered_cards.all %}
          🃏 {{ card.name }}<br>
        {% endfor %}

        <strong>For your card(s):</strong><br>
        {% for card in trade.requested_cards.all %}
          🃏 {{ card.name }}<br>
        {% endfor %}

        <strong>Status:</strong>
        {% if trade.status == 'pending' %}
          <span style="color: orange;">⏳ Pending</span>
        {% elif trade.status == 'accepted' %}
          <span style="color: green;">✅ Accepted</span>
        {% else %}
          <span style="color: red;">❌ Rejected</span>
        {% endif %}
        <br>
        {% if trade.status == 'pending' %}
        <form method="post" action="{% url 'accept_trade' trade.id %}" style="display:inline;">
          {% csrf_token %}
          <button type="submit">Accept</button>
        </form>
        <form method="post" action="{% url 'reject_trade' trade.id %}" style="display:inline;">
          {% csrf_token %}
          <button type="submit" style="background-color:#dc3545;">Reject</button>
        </form>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No incoming trade requests.</p>
{% endif %}

<hr>

<h2>Outgoing Trade Requests</h2>

{% if outgoing_requests %}
  <ul>
    {% for trade in outgoing_requests %}
      <li style="margin-bottom: 20px; border-bottom: 1px solid #ccc; padding-bottom: 10px;">
        <strong>To:</strong> {{ trade.to_user.userprofile.display_name|default:trade.to_user.username }}<br>

        <strong>You offered:</strong><br>
        {% for card in trade.offered_cards.all %}
          🃏 {{ card.name }}<br>
        {% endfor %}

        <strong>For:</strong><br>
        {% for card in trade.requested_cards.all %}
          🃏 {{ card.name }}<br>
        {% endfor %}

        <strong>Status:</strong>
        {% if trade.status == 'pending' %}
          <span style="color: orange;">⏳ Pending</span>
        {% elif trade.status == 'accepted' %}
          <span style="color: green;">✅ Accepted</span>
        {% else %}
          <span style="color: red;">❌ Rejected</span>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No outgoing trade requests.</p>
{% endif %}
{% endblock %}

